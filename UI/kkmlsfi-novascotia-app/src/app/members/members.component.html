<div class="container-fluid">
    <div class="mt-3">
        <h3 class="float-start me-2">Members List</h3>
        @if (isAdmin) {
            <a routerLink="/admin/members/add" class="btn btn-outline-primary border-0"
                data-toggle="tooltip" title="Add New Member">
                <i class="bi bi-pencil-square"></i>
            </a>
        }
        <div class="btn-toolbar float-end" role="toolbar">
            <form (submit)="onSearch(searchFilter)">
                <div class="input-group">
                    <input type="text" class="form-control" placeholder="Search member" id="searchFilter" name="searchFilter" [(ngModel)]="searchFilter">
                    <button type="submit" class="btn btn-success" 
                        data-toggle="tooltip" title="Search">
                        <i class="bi bi-search"></i>
                    </button>
                </div>
            </form>
        </div>
    </div>

    @if (members$ | async; as members) {
        <table class="table table-hover mt-3">
            <thead class="table-light">
                <tr>
                    <th>
                        First Name
                        <span>
                            <span>
                                <button type="button" class="btn btn-sm btn-light" (click)="sort('First Name', 'asc')" 
                                    data-toggle="tooltip" title="Ascending">
                                    <i class="bi bi-arrow-up"></i>
                                </button>
                            </span>
                            <span>
                                <button type="button" class="btn btn-sm btn-light" (click)="sort('First Name', 'desc')"
                                    data-toggle="tooltip" title="Descending">
                                    <i class="bi bi-arrow-down"></i>
                                </button>
                            </span>
                        </span>
                    </th>
                    <th>Middle Name</th>
                    <th>
                        Last Name
                        <span>
                            <span>
                                <button type="button" class="btn btn-sm btn-light" (click)="sort('Last Name', 'asc')"
                                    data-toggle="tooltip" title="Ascending">
                                    <i class="bi bi-arrow-up"></i>
                                </button>
                            </span>
                            <span>
                                <button type="button" class="btn btn-sm btn-light" (click)="sort('Last Name', 'desc')"
                                    data-toggle="tooltip" title="Descending">
                                    <i class="bi bi-arrow-down"></i>
                                </button>
                            </span>
                        </span>
                    </th>
                    <th>Date of Birth</th>
                    <th>City</th>
                    @if (isAdmin) {
                        <th class="text-end"></th>
                    }
                </tr>
            </thead>
            <tbody>
                @for (member of members; track member.memberId) {
                    <tr>
                        <td>{{ member.firstName }}</td>
                        <td>{{ member.middleName }}</td>
                        <td>{{ member.lastName }}</td>
                        <td>{{ member.dateOfBirth }}</td>
                        <td>{{ member.city }}</td>
                        @if (isAdmin) {
                            <td class="text-end">
                                <!-- <div class="btn-group">
                                    <input type="button" class="btn btn-warning btn-sm" value="Update" [routerLink]="['/admin/members/update',member.memberId]">
                                    <input type="button" class="btn btn-danger btn-sm" value="Delete" (click)="onDeleteMember(member)">
                                </div> -->
                                <div>
                                    <a [routerLink]="['/admin/members/update',member.memberId]" class="btn btn-outline-warning border-0 me-2"
                                        data-toggle="tooltip" title="Update">
                                        <i class="bi bi-pencil-fill"></i>
                                    </a>
                                    
                                    <a (click)="onDeleteMember(member)" class="btn btn-outline-danger border-0" 
                                        data-toggle="tooltip" title="Delete">
                                        <i class="bi bi-trash-fill"></i>
                                    </a>
                                </div>
                            </td>
                        }
                    </tr>
                }
            </tbody>
        </table>

        <nav class="d-flex justify-content-center">
            <ul class="pagination">
                <li class="page-item">
                    <a class="page-link" role="button" [class.disabled] = "pageNumber === 1" (click)="onPreviousPage()">
                      <span>&laquo;</span>
                    </a>
                  </li>
    
                @for (page of pageList; track $index) {
                    <li class="page-item"><a class="page-link" role="button" [class.active] = "pageNumber === $index + 1" (click)="onPageChange($index + 1)">{{ $index + 1 }}</a></li>
                }
    
                <li class="page-item">
                    <a class="page-link" role="button" [class.disabled] = "pageNumber === pageList.length" (click)="onNextPage()">
                      <span>&raquo;</span>
                    </a>
                </li>
            </ul>
        </nav>
    } @else {
        <p class="center mt-3">No records.</p>
    }
</div>